<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Introduction to trophic SDM</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to trophic SDM</h1>



<p>In this vignette we explain how to fit, evaluate and interpret a
trophic species distribution model (trophic SDM). Trophic SDM is a
statistical model to model the distribution of species accounting for
their known trophic interactions. We refer to Poggiato et al.,
“Integrating trophic food webs in species distribution models improves
ecological niche estimation and prediction”, in preparation for the full
description of trophic SDM.</p>
<div id="install-and-load-websdm" class="section level2">
<h2>Install and load webSDM</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(devtools)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co"># Run to install webSDM</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co"># install_github(&quot;giopogg/webSDM&quot;)</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(webSDM)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="fu">library</span>(loo)</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span></code></pre></div>
</div>
<div id="simulate-data" class="section level2">
<h2>Simulate data</h2>
<p>For illustrative purposes, we use simulated data for which we know
the parameter values. We thus simulate a trophic interaction network and
species distribution for six species, whose names are ordered
accordingly to their trophic level (Y1 being basal and Y6 being at the
highest trophic position). We simulate data with a stronger dependence
on the abiotic variables for species in lower trophic levels, and
increasing dependence on the biotic terms (i.e., their preys) for
species with a higher trophic level. We will then use trophic SDM and
see if the model can retrieve this simulate process and the species
potential niches.</p>
<div id="create-trophic-interaction-network" class="section level3">
<h3>Create trophic interaction network</h3>
<p>We first create the trophic interaction network. The network needs to
be a directed acyclic graph (DAG), with arrows pointing from predator to
prey. We thus simulate an interaction network such that species only
have prey in a lower trophic position.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Set number of species</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>S <span class="ot">=</span> <span class="dv">6</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co"># Create the adjacency matrix of the graph</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>A <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>S,<span class="at">ncol=</span>S)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co"># Ensure that the graph is connected</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="cf">while</span>(<span class="sc">!</span>igraph<span class="sc">::</span><span class="fu">is.connected</span>(igraph<span class="sc">::</span><span class="fu">graph_from_adjacency_matrix</span>(A))){</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>  A <span class="ot">=</span> A_w <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span>S,<span class="at">ncol=</span>S)</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>  <span class="co"># Create links (i.e. zeros and ones of the adjacency matrix)</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(S<span class="dv">-1</span>)){</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>    A[<span class="fu">c</span>((j<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>S),j] <span class="ot">=</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), S<span class="sc">-</span>j, <span class="at">replace =</span> T)</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>  }</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>  <span class="co"># Sample weights for each link</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a>  <span class="co">#A_w[which(A != 0)] = runif(1,min=0,max=2)</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>}</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="fu">colnames</span>(A) <span class="ot">=</span> <span class="fu">rownames</span>(A) <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&quot;Y&quot;</span>,<span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span>S))</span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="co"># Build an igraph object from A</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>G <span class="ot">=</span> igraph<span class="sc">::</span><span class="fu">graph_from_adjacency_matrix</span>(A)</span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="fu">plot</span>(G)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="plot of chunk simulate_graph" />
<div class="figcaption">plot of chunk simulate_graph</div>
</div>
</div>
<div id="simulate-data-1" class="section level3">
<h3>Simulate data</h3>
<p>We now simulate species distribution at 300 locations along two
environmental gradients. We simulate species such that species Y1 to Y3
have a negative dependence to the first environmental variable X_1 and a
positive dependence to X_2, viceversa for species Y4 to Y6. Moreover,
the strength of the environmental term decreases along the trophic
level, while the effect of the prey increases. Finally, preys always
have a positive effect on predators.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Number of sites</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">500</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co"># Simulate environmental gradient</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>X_1<span class="ot">=</span> <span class="fu">scale</span>(<span class="fu">runif</span>(n, <span class="at">max =</span> <span class="dv">1</span>))</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>X_2<span class="ot">=</span> <span class="fu">scale</span>(<span class="fu">runif</span>(n, <span class="at">max =</span> <span class="dv">1</span>))</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">cbind</span>(<span class="dv">1</span>, X_1<span class="sc">^</span><span class="dv">2</span>, X_2<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>B <span class="ot">=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>             <span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>             <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">2</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>             ), <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a><span class="co"># Sample the distribution of each species as a logit model as a function of the</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="co"># environment and the distribution of preys</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>Y <span class="ot">=</span> V <span class="ot">=</span> prob <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> n, <span class="at">ncol =</span> S)</span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>S){</span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a>  <span class="co"># The logit of the probability of presence of each species is given by the </span></span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a>  <span class="co"># effect of the environment and of the preys.</span></span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a>  </span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a>  <span class="co"># Create the linear term. As j increases, the weight of the environmental effect </span></span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a>  <span class="co"># decreases and the biotic effect increases</span></span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a>  eff_bio <span class="ot">=</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">length.out =</span> S)[j]</span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a>  eff_abio <span class="ot">=</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">length.out =</span> S)[S<span class="sc">+</span><span class="dv">1</span><span class="sc">-</span>j]</span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a>  V[,j]<span class="ot">=</span> eff_abio<span class="sc">*</span>X<span class="sc">%*%</span>B[j,] <span class="sc">+</span> eff_bio<span class="sc">*</span>Y<span class="sc">%*%</span>A[j,]<span class="sc">*</span><span class="dv">3</span></span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a>  <span class="co"># Transform to logit</span></span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a>  prob[,j] <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>V[,j]))</span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a>  <span class="co"># Sample the probability of presence</span></span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a>  Y[,j] <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="at">n =</span> n, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> prob[,j])</span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a>  </span>
<span id="cb3-33"><a href="#cb3-33" tabindex="-1"></a>}</span>
<span id="cb3-34"><a href="#cb3-34" tabindex="-1"></a></span>
<span id="cb3-35"><a href="#cb3-35" tabindex="-1"></a><span class="co"># Set names</span></span>
<span id="cb3-36"><a href="#cb3-36" tabindex="-1"></a><span class="fu">colnames</span>(Y) <span class="ot">=</span> <span class="fu">paste0</span>(<span class="st">&quot;Y&quot;</span>,<span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span>S))</span></code></pre></div>
</div>
</div>
<div id="fit-trophic-sdm" class="section level2">
<h2>Fit trophic SDM</h2>
<p>Now that we simulate the data, we can fit a species distribution
model with the function <code>trophicSDM</code>. The function requires
the species distribution data <code>Y</code> (a sites x species matrix),
the environmental variables <code>X</code> and an igraph object
<code>G</code> representing the trophic interaction network.
Importantly, <code>G</code> must be acyclic and arrows must point from
predator to prey. Finally, the user has to specify a formula for the
environmental part of the model and the description of the error
distribution and link function to be used in the model (parameter
<code>family</code>), just as with any <code>glm</code>.<br />
By default, <code>trophicSDM</code> models each species as a function of
their prey (set <code>mode = &quot;predator&quot;</code> to model species as a
function of their predators) and of the environmental variables (as
defined in <code>env.formula</code>). Trophic SDM can be also fitted as
a function of the summary variables of preys (i.e. composite variables
like prey richness), instead of each prey species directly. We cover
this topic in the vignette ‘Composite variables’.<br />
The algorithm behind trophic SDM fits a set of generalised linear model
(glm), one for each species. These glm can be fitted in the frequentist
framework by relying on the function <code>glm</code> (set
<code>method = &quot;glm&quot;</code>), or in the Bayesian framework by relying on
the function <code>rstanarm</code> (set
<code>method = &quot;stan_glm&quot;</code>, the default choice). Model fitting is
parallelised if <code>run.parallel = TRUE</code>. These glm can be
penalised to shrink regression coefficients (by default the model is run
without penalisation). In the Bayesian framework set
<code>penal = &quot;horshoe&quot;</code> to implement penalised glm using horshoe
prior. In the frequentist framework set
<code>penal = &quot;elasticnet&quot;</code> to implement penalised glm with
elasticnet. See the examples in <code>?trophicSDM</code>. Hereafter, we
only fit trophic SDM in the Bayesian framework with no penalisation.
However, all the functions and analyses (except for MCMC diagnostic)
presented in this vignette applies straightforwardly with or without
penalisation and in the frequentist framework.</p>
<p>Hereafter we model species as a function of preys and the two
environmental covariates in the Bayesian framework without penalisation.
We though need to specify the parameters of the MCMC chains. We need to
decide how many chains to sample (<code>chains</code>), how many samples
to obtain per chain (<code>iter</code>), and if we wish to see the
progress of the MCMC sampling (<code>verbose</code>).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>iter <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>verbose <span class="ot">=</span> <span class="cn">FALSE</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>nchains <span class="ot">=</span> <span class="dv">2</span></span></code></pre></div>
<p>We are now ready to fit a trophic SDM.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">X_1 =</span> X_1, <span class="at">X_2 =</span> X_2)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>m <span class="ot">=</span> <span class="fu">trophicSDM</span>(<span class="at">Y =</span> Y, <span class="at">X =</span> X, <span class="at">G =</span> G, </span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>               <span class="at">env.formula =</span> <span class="st">&quot;~ I(X_1^2) + I(X_2^2)&quot;</span>,</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>               <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>), </span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>               <span class="at">method =</span> <span class="st">&quot;stan_glm&quot;</span>, <span class="at">chains =</span> nchains, <span class="at">iter =</span> iter, <span class="at">verbose =</span> verbose)</span></code></pre></div>
<div id="a-trophicsdmfit-object" class="section level3">
<h3>A trophicSDMfit object</h3>
<p>The fitted model <code>m</code> is of class
<code>&quot;trophicSDMfit&quot;</code>. We also show here the formulas used to fit
the each glm, where each predator is modeled as a function of the preys
and of the environmental variables.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>m</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co">#&gt; ==================================================================</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#&gt; A trophicSDM fit with no penalty, fitted using stan_glm </span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt;  with a bottom-up approach </span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#&gt;  </span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt;  Number of species : 6 </span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt;  Number of links : 10 </span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#&gt; ==================================================================</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt; * Useful fields</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#&gt;     $coef </span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co">#&gt; * Useful S3 methods</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">#&gt;     print(), coef(), plot(), predict(), evaluateModelFit() </span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co">#&gt;     predictFundamental(), plotG(), plotG_inferred(), computeVariableImportance() </span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="co">#&gt; * Local models (i.e. single species SDM) can be accessed through </span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="co">#&gt;     $model</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="fu">class</span>(m)</span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="co">#&gt; [1] &quot;trophicSDMfit&quot;</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a>m<span class="sc">$</span>form.all</span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="co">#&gt; $Y1</span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a><span class="co">#&gt; [1] &quot;y ~ I(X_1^2) + I(X_2^2)&quot;</span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a><span class="co">#&gt; $Y2</span></span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a><span class="co">#&gt; [1] &quot;y ~ I(X_1^2)+I(X_2^2)+Y1&quot;</span></span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a><span class="co">#&gt; $Y3</span></span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a><span class="co">#&gt; [1] &quot;y ~ I(X_1^2)+I(X_2^2)+Y1+Y2&quot;</span></span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a><span class="co">#&gt; $Y4</span></span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a><span class="co">#&gt; [1] &quot;y ~ I(X_1^2)+I(X_2^2)+Y1+Y3&quot;</span></span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a><span class="co">#&gt; $Y5</span></span>
<span id="cb6-33"><a href="#cb6-33" tabindex="-1"></a><span class="co">#&gt; [1] &quot;y ~ I(X_1^2)+I(X_2^2)+Y1+Y3+Y4&quot;</span></span>
<span id="cb6-34"><a href="#cb6-34" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-35"><a href="#cb6-35" tabindex="-1"></a><span class="co">#&gt; $Y6</span></span>
<span id="cb6-36"><a href="#cb6-36" tabindex="-1"></a><span class="co">#&gt; [1] &quot;y ~ I(X_1^2)+I(X_2^2)+Y3+Y5&quot;</span></span></code></pre></div>
</div>
</div>
<div id="analyse-a-fitted-trophicsdm" class="section level2">
<h2>Analyse a fitted trophicSDM</h2>
<p>The field <code>$model</code> contains all the the single species glm
(i.e., all the local models). <code>$data</code> and
<code>trophicSDM</code> contains informations on the data and choices to
fit the model respectively. <code>$form.all</code> contains the formula
used to fit each glm (i.e., both abiotic and biotic terms).
<code>$coef</code> contains the inferred regression coefficients of the
glm for all species. <code>$AIC</code> and <code>$log.lik</code> are
respectively the AIC and log-likelihood of the fitted trophic SDM.
Finally, in the Bayesian framework, the field <code>$mcmc.diag</code>
contains the convergence diagnostic metrics of the MCMC chains for each
species.</p>
<p>In this vignette, we first ensure that the MCMC chains correctly
converged. Then, we analyse the inferred model, by focusing in
particular on the effect of the biotic versus abiotic terms. We then
analyse the predictive performances of the model (comparing it to
environment-only SDM) and use it to predict the species potential
niches.</p>
<div id="mcmc-convergence" class="section level3">
<h3>MCMC convergence</h3>
<p>First, we can have a look at effective sample size to total sample
size and of the potential scale reduction factor (aka ‘R hat’) for each
species. Each line corresponds to a given parameter.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># Plot mcmc potential scale reduction factor (aka rhat)</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>p1 <span class="ot">=</span> <span class="fu">mcmc_rhat</span>(m<span class="sc">$</span>mcmc.diag<span class="sc">$</span>rhat)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co"># Plot mcmc ratio of effective sample size to total sample size</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>p2 <span class="ot">=</span> <span class="fu">mcmc_neff</span>(m<span class="sc">$</span>mcmc.diag<span class="sc">$</span>neff.ratio)</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="plot of chunk mcmc-convergence-I" />
<div class="figcaption">plot of chunk mcmc-convergence-I</div>
</div>
<p>We observe that the effective sample sizes are very close to the
theoretical value of the actual number of samples, as the ratio is close
to 1. In few cases the ratio is lower, and we might consider running the
chains for longer, or thin them, to improve convergence. This indicates
that there is very little autocorrelation among consecutive samples. The
potential scale reduction factors are very close to one, which indicates
that two chains gave consistent results. We can have a closer look to
the MCMC chains by looking at the traceplots of the parameters of a
given model, for example here for species Y5 who feeds on species Y1,
Y2, Y3 and Y4. To do so, we first assess the local model of species Y5,
and in particular its field <code>$model</code> that gives us the output
of the function <code>stan_glm</code>. We can then exploit the plot
method of this object.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">plot</span>(m<span class="sc">$</span>model<span class="sc">$</span>Y5<span class="sc">$</span>model, <span class="st">&quot;trace&quot;</span>)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="plot of chunk mcmc-convergence-II" />
<div class="figcaption">plot of chunk mcmc-convergence-II</div>
</div>
<p>Again, we see that the chains mix very well and that there’s little
autocorrelation among samples within the same chain.</p>
</div>
<div id="parameter-estimates-and-interpretation" class="section level3">
<h3>Parameter estimates and interpretation</h3>
<p>We now analyse the estimates of the regression coefficients. We can
have a first glance of the regression coefficients with the function
plot. This function plots the posterior distribution of the regression
coefficients of each species.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">plot</span>(m)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="plot of chunk estimates-I" />
<div class="figcaption">plot of chunk estimates-I</div>
</div>
<p>We can visually see that the regression coefficients for the
environmental part of the model match the simulated parameters, as
species Y1 to Y3 have a positive response to X_1 and a negative one to
X_2, viceversa for species Y3 to Y6. We also remark that the
environmental coefficients are less important for basal species than for
predators. Indeed, the posterior mean of the regression coefficients of
the environmental part gets closer to zero and their posterior
distribution tend to overlap zero more and more as we move from species
Y1 to species Y6. We can quantify this visual assessment by looking at
the posterior mean and quantile of the regression coefficients. The
parameter <code>level</code> set the probability of the quantile
(default 0.95).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">coef</span>(m, <span class="at">level =</span> <span class="fl">0.9</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co">#&gt; $Y1</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="co">#&gt;                  mean         5%       95%</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co">#&gt; (Intercept)  1.193315  0.8631366  1.551786</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co">#&gt; I(X_1^2)    -2.153769 -2.4827322 -1.854351</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co">#&gt; I(X_2^2)     1.904532  1.5618766  2.281827</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="co">#&gt; $Y2</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co">#&gt;                   mean          5%        95%</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="co">#&gt; (Intercept)  0.4378192 -0.05096073  0.9425659</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="co">#&gt; I(X_1^2)    -1.3103497 -1.64827655 -0.9781233</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="co">#&gt; I(X_2^2)     1.6693748  1.28262664  2.0953004</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="co">#&gt; Y1           1.1014760  0.60271353  1.6253656</span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a><span class="co">#&gt; $Y3</span></span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a><span class="co">#&gt;                   mean         5%       95%</span></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a><span class="co">#&gt; (Intercept)  0.9246159  0.3048754  1.537713</span></span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a><span class="co">#&gt; I(X_1^2)    -1.3782372 -1.7729318 -1.011603</span></span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a><span class="co">#&gt; I(X_2^2)     1.2837309  0.8501504  1.799605</span></span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a><span class="co">#&gt; Y1           0.8750454  0.2487845  1.523552</span></span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a><span class="co">#&gt; Y2           1.3356857  0.7836524  1.874160</span></span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a><span class="co">#&gt; $Y4</span></span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a><span class="co">#&gt;                  mean         5%        95%</span></span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.149971 -0.9501498  0.6711274</span></span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a><span class="co">#&gt; I(X_1^2)     1.132746  0.7019883  1.5938620</span></span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a><span class="co">#&gt; I(X_2^2)    -1.138931 -1.5981180 -0.6976561</span></span>
<span id="cb10-28"><a href="#cb10-28" tabindex="-1"></a><span class="co">#&gt; Y1           2.550784  1.6477388  3.4849039</span></span>
<span id="cb10-29"><a href="#cb10-29" tabindex="-1"></a><span class="co">#&gt; Y3           2.000125  1.2299528  2.9196692</span></span>
<span id="cb10-30"><a href="#cb10-30" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-31"><a href="#cb10-31" tabindex="-1"></a><span class="co">#&gt; $Y5</span></span>
<span id="cb10-32"><a href="#cb10-32" tabindex="-1"></a><span class="co">#&gt;                   mean          5%        95%</span></span>
<span id="cb10-33"><a href="#cb10-33" tabindex="-1"></a><span class="co">#&gt; (Intercept)  0.5422551 -0.76409358  2.0854414</span></span>
<span id="cb10-34"><a href="#cb10-34" tabindex="-1"></a><span class="co">#&gt; I(X_1^2)     0.9843555  0.02913223  2.0103196</span></span>
<span id="cb10-35"><a href="#cb10-35" tabindex="-1"></a><span class="co">#&gt; I(X_2^2)    -1.4438633 -2.74833106 -0.2571721</span></span>
<span id="cb10-36"><a href="#cb10-36" tabindex="-1"></a><span class="co">#&gt; Y1           3.0216650  0.36971766  6.3588373</span></span>
<span id="cb10-37"><a href="#cb10-37" tabindex="-1"></a><span class="co">#&gt; Y3           4.4991171  2.06335620  7.4694324</span></span>
<span id="cb10-38"><a href="#cb10-38" tabindex="-1"></a><span class="co">#&gt; Y4           1.9616552  0.64162409  3.4955833</span></span>
<span id="cb10-39"><a href="#cb10-39" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-40"><a href="#cb10-40" tabindex="-1"></a><span class="co">#&gt; $Y6</span></span>
<span id="cb10-41"><a href="#cb10-41" tabindex="-1"></a><span class="co">#&gt;                    mean         5%       95%</span></span>
<span id="cb10-42"><a href="#cb10-42" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.18963593 -2.0485881 1.5794885</span></span>
<span id="cb10-43"><a href="#cb10-43" tabindex="-1"></a><span class="co">#&gt; I(X_1^2)     0.06055848 -0.9455691 0.9899717</span></span>
<span id="cb10-44"><a href="#cb10-44" tabindex="-1"></a><span class="co">#&gt; I(X_2^2)    -0.18911690 -1.2013288 0.8962215</span></span>
<span id="cb10-45"><a href="#cb10-45" tabindex="-1"></a><span class="co">#&gt; Y3           3.62070445  1.1223913 6.5666245</span></span>
<span id="cb10-46"><a href="#cb10-46" tabindex="-1"></a><span class="co">#&gt; Y5           3.69026866  2.1993395 5.4164494</span></span></code></pre></div>
<p>Notice that regression coefficients are directly available in the
field <code>$coef</code> of an object trophicSDMfit (with
<code>level = 0.95</code>). As we previously hinted, we see that the
estimate of the regression coefficients of the environmental part get
closer and closer to zero with credible interval that often overlap zero
(implying they are not significant with a confidence level of 10%) for
species with a higher trophic level. In order to be able to correctly
quantify the effect of the different predictors across species (i.e.,
their relative importance), we need to standardise the regression
coefficients (see Grace et al. 2018). To do so, we need to set
<code>standardise = TRUE</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">coef</span>(m, <span class="at">level =</span> <span class="fl">0.9</span>, <span class="at">standardise =</span> T)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co">#&gt; $Y1</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co">#&gt;               estimate         5%        95%</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt; (Intercept)  1.1933152  1.1933152  1.1933152</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt; I(X_1^2)    -0.6032735 -0.6954163 -0.5194061</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt; I(X_2^2)     0.5524401  0.4530474  0.6618806</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; $Y2</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt;               estimate          5%        95%</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#&gt; (Intercept)  0.4378192  0.43781923  0.4378192</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="co">#&gt; I(X_1^2)    -0.3967764 -0.49910135 -0.2961777</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co">#&gt; I(X_2^2)     0.5234732  0.40219885  0.6570325</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co">#&gt; Y1           0.1815471  0.09934023  0.2678954</span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="co">#&gt; $Y3</span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="co">#&gt;               estimate          5%        95%</span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="co">#&gt; (Intercept)  0.9246159  0.92461585  0.9246159</span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a><span class="co">#&gt; I(X_1^2)    -0.4018688 -0.51695451 -0.2949649</span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a><span class="co">#&gt; I(X_2^2)     0.3876289  0.25670715  0.5433997</span></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a><span class="co">#&gt; Y1           0.1388822  0.03948565  0.2418093</span></span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a><span class="co">#&gt; Y2           0.2027708  0.11896649  0.2845168</span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a><span class="co">#&gt; $Y4</span></span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a><span class="co">#&gt;               estimate         5%        95%</span></span>
<span id="cb11-25"><a href="#cb11-25" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.1499710 -0.1499710 -0.1499710</span></span>
<span id="cb11-26"><a href="#cb11-26" tabindex="-1"></a><span class="co">#&gt; I(X_1^2)     0.4526599  0.2805236  0.6369279</span></span>
<span id="cb11-27"><a href="#cb11-27" tabindex="-1"></a><span class="co">#&gt; I(X_2^2)    -0.4713231 -0.6613485 -0.2887107</span></span>
<span id="cb11-28"><a href="#cb11-28" tabindex="-1"></a><span class="co">#&gt; Y1           0.5548413  0.3584128  0.7580292</span></span>
<span id="cb11-29"><a href="#cb11-29" tabindex="-1"></a><span class="co">#&gt; Y3           0.3802667  0.2338405  0.5550919</span></span>
<span id="cb11-30"><a href="#cb11-30" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-31"><a href="#cb11-31" tabindex="-1"></a><span class="co">#&gt; $Y5</span></span>
<span id="cb11-32"><a href="#cb11-32" tabindex="-1"></a><span class="co">#&gt;               estimate           5%         95%</span></span>
<span id="cb11-33"><a href="#cb11-33" tabindex="-1"></a><span class="co">#&gt; (Intercept)  0.5422551  0.542255094  0.54225509</span></span>
<span id="cb11-34"><a href="#cb11-34" tabindex="-1"></a><span class="co">#&gt; I(X_1^2)     0.2863784  0.008475438  0.58486205</span></span>
<span id="cb11-35"><a href="#cb11-35" tabindex="-1"></a><span class="co">#&gt; I(X_2^2)    -0.4350071 -0.828017071 -0.07748081</span></span>
<span id="cb11-36"><a href="#cb11-36" tabindex="-1"></a><span class="co">#&gt; Y1           0.4785091  0.058548274  1.00698178</span></span>
<span id="cb11-37"><a href="#cb11-37" tabindex="-1"></a><span class="co">#&gt; Y3           0.6227408  0.285597372  1.03387396</span></span>
<span id="cb11-38"><a href="#cb11-38" tabindex="-1"></a><span class="co">#&gt; Y4           0.1816850  0.059426083  0.32375471</span></span>
<span id="cb11-39"><a href="#cb11-39" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-40"><a href="#cb11-40" tabindex="-1"></a><span class="co">#&gt; $Y6</span></span>
<span id="cb11-41"><a href="#cb11-41" tabindex="-1"></a><span class="co">#&gt;                estimate         5%        95%</span></span>
<span id="cb11-42"><a href="#cb11-42" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.18963593 -0.1896359 -0.1896359</span></span>
<span id="cb11-43"><a href="#cb11-43" tabindex="-1"></a><span class="co">#&gt; I(X_1^2)     0.02223722 -0.3472152  0.3635200</span></span>
<span id="cb11-44"><a href="#cb11-44" tabindex="-1"></a><span class="co">#&gt; I(X_2^2)    -0.07191471 -0.4568244  0.3408025</span></span>
<span id="cb11-45"><a href="#cb11-45" tabindex="-1"></a><span class="co">#&gt; Y3           0.63254324  0.1960837  1.1472005</span></span>
<span id="cb11-46"><a href="#cb11-46" tabindex="-1"></a><span class="co">#&gt; Y5           0.17891028  0.1066276  0.2625983</span></span></code></pre></div>
<p>This results confirms the previous analysis. We can analyse the
relative importance of different group of variables with the function
<code>computeVariableImportance</code>. This function can take as input
the definition of groups of variables in the argument
<code>groups</code> (by default, with <code>groups = NULL</code>, each
explanatory variable is a different group). The variable importance of
groups of variables is computed as the standardised regression
coefficients summed across variable of the same group.<br />
We hereafter use this function to compute the relative importance of the
abiotic versus biotic covariates.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>VarImpo <span class="ot">=</span> <span class="fu">computeVariableImportance</span>(m, </span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>                                    <span class="at">groups =</span> <span class="fu">list</span>(<span class="st">&quot;Abiotic&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;X_1&quot;</span>,<span class="st">&quot;X_2&quot;</span>),</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>                                                     <span class="st">&quot;Biotic&quot;</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;Y1&quot;</span>,<span class="st">&quot;Y2&quot;</span>, <span class="st">&quot;Y3&quot;</span>, <span class="st">&quot;Y4&quot;</span>, <span class="st">&quot;Y5&quot;</span>, <span class="st">&quot;Y6&quot;</span>)))</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>VarImpo <span class="ot">=</span> <span class="fu">apply</span>(VarImpo, <span class="dv">2</span>, <span class="cf">function</span>(x) x<span class="sc">/</span>(x[<span class="dv">1</span>]<span class="sc">+</span>x[<span class="dv">2</span>]))</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>tab <span class="ot">=</span> reshape2<span class="sc">::</span><span class="fu">melt</span>(VarImpo)</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>tab<span class="sc">$</span>Var2 <span class="ot">=</span> <span class="fu">factor</span>(tab<span class="sc">$</span>Var2, <span class="at">levels =</span> <span class="fu">colnames</span>(Y))</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="fu">ggplot</span>(tab, <span class="fu">aes</span>(<span class="at">x =</span> Var2, <span class="at">y =</span> value, <span class="at">fill =</span> Var1)) <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAGwCAMAAABy/YdMAAAA81BMVEUAAAAAADoAAGYAOpAAZmYAZrYAv8QzMzM6AAA6ADo6AGY6Ojo6OmY6OpA6ZrY6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmAGZmOgBmOjpmOmZmOpBmtttmtv9uTU1uTY5ubqtujshuq6tuq+SOTU2OTY6ObquOjk2OjsiOq+SOyP+QOgCQOjqQOmaQ2/+rbk2rbm6rbo6r5P+2ZgC2Zjq2Zma2tma2/7a2/9u2///Ijk3Ijm7Ijo7IyP/I///bkDrb/9vb///kq27kq47k/8jk///4dm3/tmb/yI7/25D/29v/5Kv//7b//8j//9v//+T////+SxBnAAAACXBIWXMAAAsSAAALEgHS3X78AAAPTElEQVR4nO2ba1sb1xVGFTtUSepUcmzn1spJS0Jt4eIW0ouxAwWXChUE8/9/TeciAcIjec7ee87WzKz3A0I8ez3n5SyOZsByLyGdTM+7APEJ4jsaxHc0iO9oAsTzM9KmIL6jQXxHg/iOBvEdDeI7GsR3NIjvaBDf0SC+o0F8R4P4jgbxHQ3iOxrEdzSI72jKbZ6Os4/Xr4dPiw9rRkkzU2rzcJiLP99ODsf5h9WjpKEpszn7tTjx7/dT9/mHJOn3+zej/xXGkdY19/+27bPupf5t5vxtIf7uqOcOqGDE32ad+LsnPkG8EG6g+FXXeM8dUMGIv81K8bOds1V39Z47oIIRfxvJ7/GeO6CCEV9iM2DUcwdUMOJLbAaMeu6ACkZ8ic2AUc8dUMGIL7EZMOq5AyoY8SU2A0Y9d0AFI77EZsCo5w6oYMSX2AwY9dwBFYz4EpsBo547oIIRX2IzYNRzB1Qw4ktsBox67oAKRnyJzYBRzx1QwYgvsRkw6rkDKhjxJTYDRj13QAUjvsRmwKjnDqhgxJfYDBj13AEVjPgSmwGjnjugghFfYjNg1HMHVDDiS2wGjHrugApGfInNgFHPHVDBiC+xGTDquQMqGPElNgNGPXdABSO+xGbAqOcOqGDEl9gMGPXcARWM+BKbAaOeO6CCEV9iM2DUcwdUMOJLbAaMeu6ACkZ8ic2AUc8dUMGIL7EZMOq5AyoY8SU2A0Y9d0AFI77EZsCo5w6oYMSX2AwY9dwBFYz4EpsBo547oII9xf9GGKXfj9sMGNXtgAuta25RHPEutK65RXHEu9C65hbFEe9C65pbFEe8C61rblEc8S60rrlFccS70LrmFsUR70LrmlsUR7wLrWtuURzxLrSuuUVxxLvQuuYWxRHvQuuaWxRHvAuta25RHPEutK65RXHEu9C65hbFEe9C65pbFEe8C61rblEc8S60rrlFccS70LrmFsUR70LrmlsUR7wLrWtuURzxLrSuuUVxxLvQuuYWxRHvQuuaWxRHvAuta25RHPEutK65RXHEu9C65hbFEe9C65pbFEe8C61rblEc8S60rrlFccS70LrmFsUR70LrmlsUR7wLrWtuURzxLrSuuUVxxLvQuuYWxRHvQuuaWxRHvAuta25RHPEutK65RXHEu9C65hbFEe9C65pbFEe8C61rblEc8S60rrlFccS70LrmFsUR70LrmlsUR7wLrWtuURzxLrSuuUVxxLvQuuYWxRHvQuuaWxRHvAuta25RvAnir18Pn2aPp8PhcDt98nh/eVS3Ay60rrlF8SaIP99ODsfFp++OZi8+GNXtgAuta25RvAni3+9n7rOkDxfPh0/OkqTf7yNeQzdB/Nsb8e+Ocvcvl0d1O+BC65pbFG+C+JsTf/HH/Pn8pwDxGroJ4m+u8Znx03FyPl4e1e2AC61rblG8CeLzu/rZzlkm/eYWH/FCuEHiPzaq2wEXWtfcojjiXWhdc4viiHehdc0tiiPehdY1tyiOeBda19yiOOJdaF1zi+KId6F1zS2KI96F1jW3KI54F1rX3KI44l1oXXOL4oh3oXXNLYoj3oXWNbcojngXWtfcojjiXWhdc4viiHehdc0tiiPehdY1tyiOeBda19yiOOJdaF1zi+KId6F1zS2KI96F1jW3KI54F1rX3KI44l1oXXOL4oh3oXXNLYoj3oXWNbcojngXWtfcojjiXWhdc4viiHehdc0tiiPehdY1tyiOeBda19yiOOJdaF1zi+KId6F1zS2KI96F1jW3KI54F1rX3KI44l1oXXOL4oh3oXXNC1inDvEutK55ASNeuH2IR3x0Wte8gBEv3D7EIz46rWtewIgXbh/iER+d1jUvYMQLtw/xiI9O65oXMOKF24d4xEendc0LGPHC7UM84qPTuuYFjHjh9iEe8dFpXfMCRrxw+xCP+Oi0rnkBI164fYhHfHRa17yAES/cPsQjPjqta17AiBduH+IRH53WNS9g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" alt="plot of chunk varImpo" />
<div class="figcaption">plot of chunk varImpo</div>
</div>
<p>We clearly see that our model correctly retrieved the simulated
pattern, with the importance of biotic variables with respect to the
abiotic ones becomes greater as the trophic level increases.</p>
<p>Finally, we can visualise the effect of each trophic interactions
with the function <code>plotG_inferred</code>, which plots the metaweb
<code>G</code> together with the variable importance (i.e. the
standardised regression coefficient) of each link. The parameter
<code>level</code> sets the confidence level with which coefficients are
deemed as significant or non-significant.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">plotG_inferred</span>(m, <span class="at">level =</span> <span class="fl">0.9</span>)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="plot of chunk plotG" />
<div class="figcaption">plot of chunk plotG</div>
</div>
<p>We see that the model correctly retrieves that preys have a posite
effect on the predators and that this effect becomes more important for
predators at higher trophic positions.</p>
</div>
<div id="analysis-of-local-models" class="section level3">
<h3>Analysis of local models</h3>
<p>In order to examine the package and practice with it, we here show
how to easily manipulate local models, i.e. each glm (that can be seen
as a single species SDMs), the smallest pieces of trophic SDM. These
local models belong to the class “SDMfit”, for which multiple methods
exists. We hereafter show how to some of these methods for species
Y6.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>SDM <span class="ot">=</span> m<span class="sc">$</span>model<span class="sc">$</span>Y6</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co"># The formula used to fit the model</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>SDM<span class="sc">$</span>form.all</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="co">#&gt; [1] &quot;y ~ I(X_1^2)+I(X_2^2)+Y3+Y5&quot;</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="co"># The inferred model</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="fu">plot</span>(SDM)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="plot of chunk SDMfit" />
<div class="figcaption">plot of chunk SDMfit</div>
</div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="co"># The regression coefficients</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="fu">coef</span>(SDM, <span class="at">level =</span> <span class="fl">0.9</span>, <span class="at">standardise =</span> T)</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co">#&gt;                estimate         5%        95%</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="co">#&gt; (Intercept) -0.18963593 -0.1896359 -0.1896359</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co">#&gt; I(X_1^2)     0.02223722 -0.3472152  0.3635200</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co">#&gt; I(X_2^2)    -0.07191471 -0.4568244  0.3408025</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="co">#&gt; Y3           0.63254324  0.1960837  1.1472005</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co">#&gt; Y5           0.17891028  0.1066276  0.2625983</span></span></code></pre></div>
<p>We can also predict the probability of presence of species Y6 at a
site with X_1 = 0.5, X_2 = 0.5, assuming its preys to be present
present.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>preds <span class="ot">=</span> <span class="fu">predict</span>(SDM, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">X_1 =</span> <span class="fl">0.5</span>, <span class="at">X_2 =</span> <span class="fl">0.5</span>, <span class="at">Y3 =</span> <span class="dv">1</span>, <span class="at">Y5 =</span> <span class="dv">1</span>))</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="co"># Posterior mean of the probability of presence</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="fu">mean</span>(preds<span class="sc">$</span>predictions.prob)</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="co">#&gt; [1] 0.9983807</span></span></code></pre></div>
<p>We see that the species has a high probability of presence in this
environmental conditions when its prey are present.</p>
</div>
</div>
<div id="predictions-with-trophic-sdm" class="section level2">
<h2>Predictions with trophic SDM</h2>
<p>We showed how to fit and analyse a trophic SDM and how to predict a
single species (Y6 in the previous section), when we can fix the
distribution of its prey. However, the distribution of prey is typically
unavailable when we want to predict the distribution of species at
unobserved sites and/or under future environmental conditions.
Intuitively, in a simple network of two trophic level we would need to
predict the prey first and use these predictions to predict the
predator. To generalize this idea to complex networks, we predict
species following the topological ordering of the metaweb. This order
that exists for every DAG guarantees that when predicting a given
species, all its prey will have already been predicted.<br />
The function <code>predict</code> computes the topological order of
species, and then predicts them sequentially. As any
<code>predict</code> function, it takes into account the values of the
environmental variables in the argument <code>Xnew</code>. We can
provide to the function the number of samples from the posterior
distribution.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>pred <span class="ot">=</span> <span class="fu">predict</span>(m, <span class="at">Xnew =</span> <span class="fu">data.frame</span>(<span class="at">X_1 =</span> <span class="fl">0.5</span>, <span class="at">X_2 =</span> <span class="fl">0.5</span>), <span class="at">pred_samples =</span> <span class="dv">100</span>)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="fu">dim</span>(pred<span class="sc">$</span>Y2)</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="co">#&gt; [1]   1 100</span></span></code></pre></div>
<p>By default, the function <code>predict</code> transforms the
probability of presence of prey in presence-absence, and then use these
presence-absences to predict the predator. However, we can use directly
the probability of presence of prey by setting
<code>prob.cov = TRUE</code>.</p>
<p>Pred is a list containing the posterior distribution of the predicted
probability of presence of each species (i.e., number of sites x
pred_samples). Notice that we can ask the function to directly provide a
summary of the posterior distribution (i.e. posterior mean and 95%
quantiles) of the probabilities of presence by setting
<code>fullPost = FALSE</code>. As for <code>trophicSDM</code>, we can
choose to parallelise some parts of the <code>predict</code> function by
setting <code>run.parallel = TRUE</code> (which can speed up
computational times).</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>pred <span class="ot">=</span> <span class="fu">predict</span>(m, <span class="at">Xnew =</span> <span class="fu">data.frame</span>(<span class="at">X_1 =</span> <span class="fl">0.5</span>, <span class="at">X_2 =</span> <span class="fl">0.5</span>), <span class="at">pred_samples =</span> <span class="dv">100</span>, </span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>               <span class="at">fullPost =</span> <span class="cn">FALSE</span>, <span class="at">run.parallel =</span> <span class="cn">FALSE</span>)</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>pred<span class="sc">$</span>Y2</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co">#&gt; $predictions.mean</span></span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a><span class="co">#&gt;         1 </span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a><span class="co">#&gt; 0.7984008 </span></span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a><span class="co">#&gt; $predictions.q025</span></span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a><span class="co">#&gt;         1 </span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a><span class="co">#&gt; 0.5854847 </span></span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb18-13"><a href="#cb18-13" tabindex="-1"></a><span class="co">#&gt; $predictions.q975</span></span>
<span id="cb18-14"><a href="#cb18-14" tabindex="-1"></a><span class="co">#&gt;         1 </span></span>
<span id="cb18-15"><a href="#cb18-15" tabindex="-1"></a><span class="co">#&gt; 0.8850332</span></span></code></pre></div>
</div>
<div id="model-evaluation" class="section level2">
<h2>Model evaluation</h2>
<p>We now want to evaluate how well the model fits the data and how well
it generalises to new data with respect to classical SDM. We thus first
run a classical SDM, by providing an empty graph to
<code>trophicSDM</code>. Then, we will compare model AIC and their
predictive performances both on the training data and in
cross-validation. Notice that when we compare classical SDM and trophic
SDM it is important to account for the fact that trophic SDM have a
higher number of parameters, and will therefore have, by default, a
higher fit on the the training data.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>empty_graph <span class="ot">=</span> <span class="fu">graph_from_adjacency_matrix</span>(<span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> S, <span class="at">ncol =</span> S,</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>                                          <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">colnames</span>(Y), <span class="fu">colnames</span>(Y))))</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>m_classic <span class="ot">=</span> <span class="fu">trophicSDM</span>(<span class="at">Y =</span> Y, <span class="at">X =</span> X,</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>                       <span class="at">G =</span> empty_graph,</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>                       <span class="at">env.formula =</span> <span class="st">&quot;~ I(X_1^2) + I(X_2^2)&quot;</span>, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>), </span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>                       <span class="at">method =</span> <span class="st">&quot;stan_glm&quot;</span>, <span class="at">chains =</span> nchains, <span class="at">iter =</span> iter, <span class="at">verbose =</span> verbose)</span></code></pre></div>
<div id="aic-loo" class="section level3">
<h3>AIC, loo</h3>
<p>We first compare model AIC and an approximation of the leave-one-out
cross-validation log-likelihood (loo, see Vehtari, A. et al 2017). AIC
penalises the likelihood of the model as a function of the number of
model parameter, while loo approximate the likelihood of the model on
leave-one out cross validation. Therefore, both these metrics can be
used to correctly compare the two approaches</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>m<span class="sc">$</span>AIC</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="co">#&gt; [1] 1455.775</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>m_classic<span class="sc">$</span>AIC</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="co">#&gt; [1] 1584.531</span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="fu">loo</span>(m)</span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a><span class="co">#&gt; Warning: Found 6 observation(s) with a pareto_k &gt; 0.7. We recommend calling &#39;loo&#39; again with argument &#39;k_threshold = 0.7&#39; in order to calculate the ELPD without the assumption that these observations are negligible. This will refit the model 6 times to compute the ELPDs for the problematic observations directly.</span></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a><span class="co">#&gt; [1] -707.626</span></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a><span class="fu">loo</span>(m_classic)</span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a><span class="co">#&gt; [1] -777.2048</span></span></code></pre></div>
<p>We see that our trophic model has a lower AIC and a higher loo, which
proves that including prey improves the model.</p>
</div>
<div id="interpolation" class="section level3">
<h3>Interpolation</h3>
<p>We now compare the predictive performance of the two approaches on
the training dataset. To do so, we first use the function
<code>predict</code>, and then the function
<code>evaluateModelFit</code> to compare how well predictions match the
true data.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="co"># Trophic SDM (when Xnew is not specified, predictions are carried on</span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="co"># the training dataset by setting Xnew = m$data$X)</span></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>Ypred <span class="ot">=</span> <span class="fu">predict</span>(m, <span class="at">fullPost =</span> <span class="cn">FALSE</span>)</span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="co"># Transfom in a table</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>Ypred <span class="ot">=</span> <span class="fu">do.call</span>(cbind,</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>                <span class="fu">lapply</span>(Ypred, <span class="cf">function</span>(x) x<span class="sc">$</span>predictions.mean))</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a><span class="co"># Re order columns</span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>Ypred <span class="ot">=</span> Ypred[,<span class="fu">colnames</span>(Y)]</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>metrics <span class="ot">=</span> <span class="fu">evaluateModelFit</span>(m, <span class="at">Ynew =</span> Y, <span class="at">Ypredicted =</span> Ypred)</span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a><span class="co"># Classical SDM</span></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a>Ypred_classic <span class="ot">=</span> <span class="fu">predict</span>(m, <span class="at">fullPost =</span> <span class="cn">FALSE</span>)</span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a>Ypred_classic <span class="ot">=</span> <span class="fu">do.call</span>(cbind,</span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a>                <span class="fu">lapply</span>(Ypred_classic, <span class="cf">function</span>(x) x<span class="sc">$</span>predictions.mean))</span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a>Ypred_classic <span class="ot">=</span> Ypred_classic[,<span class="fu">colnames</span>(Y)]</span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a>metrics_classic <span class="ot">=</span> <span class="fu">evaluateModelFit</span>(m, <span class="at">Ynew =</span> Y, <span class="at">Ypredicted =</span> Ypred_classic)</span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a></span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a><span class="co"># Mean AUC</span></span>
<span id="cb21-21"><a href="#cb21-21" tabindex="-1"></a><span class="fu">mean</span>(metrics<span class="sc">$</span>auc)</span>
<span id="cb21-22"><a href="#cb21-22" tabindex="-1"></a><span class="co">#&gt; [1] 0.7937958</span></span>
<span id="cb21-23"><a href="#cb21-23" tabindex="-1"></a><span class="fu">mean</span>(metrics_classic<span class="sc">$</span>auc)</span>
<span id="cb21-24"><a href="#cb21-24" tabindex="-1"></a><span class="co">#&gt; [1] 0.8031646</span></span>
<span id="cb21-25"><a href="#cb21-25" tabindex="-1"></a></span>
<span id="cb21-26"><a href="#cb21-26" tabindex="-1"></a><span class="co"># Mean TSS</span></span>
<span id="cb21-27"><a href="#cb21-27" tabindex="-1"></a><span class="fu">mean</span>(metrics<span class="sc">$</span>tss)</span>
<span id="cb21-28"><a href="#cb21-28" tabindex="-1"></a><span class="co">#&gt; [1] 0.5325318</span></span>
<span id="cb21-29"><a href="#cb21-29" tabindex="-1"></a><span class="fu">mean</span>(metrics_classic<span class="sc">$</span>tss)</span>
<span id="cb21-30"><a href="#cb21-30" tabindex="-1"></a><span class="co">#&gt; [1] 0.5312451</span></span></code></pre></div>
<p>On the training dataset models have similar performances, with our
trophic model that slightly improves SDM’s TSS.</p>
</div>
<div id="cross-validation" class="section level3">
<h3>Cross-validation</h3>
<p>We now compare the two approaches in K-fold cross validation with the
function <code>trophicSDM_CV</code>. This function creates a partition
based on the specified number of fold (but can also takes a
user-specified partition in the argument <code>partition</code>) and run
a cross validation. This can take a bit of time. Set
<code>run.parallel = TRUE</code> if you want to reduce computation
time.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="co"># 3-fold cross validation</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>CV <span class="ot">=</span> <span class="fu">trophicSDM_CV</span>(m, <span class="at">K =</span> <span class="dv">3</span>, <span class="at">prob.cov =</span> T, <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>                   <span class="at">pred_samples =</span> <span class="dv">500</span>, <span class="at">run.parallel =</span> <span class="cn">FALSE</span>)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Fold 1 out of 3 \n&quot;</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Fold 2 out of 3 \n&quot;</span></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Fold 3 out of 3 \n&quot;</span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a><span class="co"># Transfom in a table</span></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>Ypred <span class="ot">=</span> CV<span class="sc">$</span>meanPred</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a><span class="co"># Re order columns</span></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>Ypred <span class="ot">=</span> Ypred[,<span class="fu">colnames</span>(Y)]</span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a>metrics <span class="ot">=</span> <span class="fu">evaluateModelFit</span>(m, <span class="at">Ynew =</span> Y, <span class="at">Ypredicted =</span> Ypred)</span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a></span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a><span class="co"># Classical SDM</span></span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a><span class="co"># We specify the same partition for classic SDM so that the two cross-validations are comparable.</span></span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a></span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a>CV_classic <span class="ot">=</span> <span class="fu">trophicSDM_CV</span>(m_classic, <span class="at">K =</span> <span class="dv">3</span>, <span class="at">prob.cov =</span> T, <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a>                           <span class="at">pred_samples =</span> <span class="dv">500</span>, <span class="at">run.parallel =</span> <span class="cn">FALSE</span>,</span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a>                           <span class="at">partition =</span> CV<span class="sc">$</span>partition)</span>
<span id="cb22-21"><a href="#cb22-21" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Fold 1 out of 3 \n&quot;</span></span>
<span id="cb22-22"><a href="#cb22-22" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Fold 2 out of 3 \n&quot;</span></span>
<span id="cb22-23"><a href="#cb22-23" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Fold 3 out of 3 \n&quot;</span></span>
<span id="cb22-24"><a href="#cb22-24" tabindex="-1"></a></span>
<span id="cb22-25"><a href="#cb22-25" tabindex="-1"></a>Ypred_classic <span class="ot">=</span> CV_classic<span class="sc">$</span>meanPred</span>
<span id="cb22-26"><a href="#cb22-26" tabindex="-1"></a></span>
<span id="cb22-27"><a href="#cb22-27" tabindex="-1"></a>Ypred_classic <span class="ot">=</span> Ypred_classic[,<span class="fu">colnames</span>(Y)]</span>
<span id="cb22-28"><a href="#cb22-28" tabindex="-1"></a>metrics_classic <span class="ot">=</span> <span class="fu">evaluateModelFit</span>(m, <span class="at">Ynew =</span> Y, <span class="at">Ypredicted =</span> Ypred_classic)</span>
<span id="cb22-29"><a href="#cb22-29" tabindex="-1"></a></span>
<span id="cb22-30"><a href="#cb22-30" tabindex="-1"></a><span class="co"># Mean AUC</span></span>
<span id="cb22-31"><a href="#cb22-31" tabindex="-1"></a><span class="fu">mean</span>(metrics<span class="sc">$</span>auc)</span>
<span id="cb22-32"><a href="#cb22-32" tabindex="-1"></a><span class="co">#&gt; [1] 0.6999403</span></span>
<span id="cb22-33"><a href="#cb22-33" tabindex="-1"></a><span class="fu">mean</span>(metrics_classic<span class="sc">$</span>auc)</span>
<span id="cb22-34"><a href="#cb22-34" tabindex="-1"></a><span class="co">#&gt; [1] 0.668446</span></span>
<span id="cb22-35"><a href="#cb22-35" tabindex="-1"></a></span>
<span id="cb22-36"><a href="#cb22-36" tabindex="-1"></a><span class="co"># Mean TSS</span></span>
<span id="cb22-37"><a href="#cb22-37" tabindex="-1"></a><span class="fu">mean</span>(metrics<span class="sc">$</span>tss)</span>
<span id="cb22-38"><a href="#cb22-38" tabindex="-1"></a><span class="co">#&gt; [1] 0.4260548</span></span>
<span id="cb22-39"><a href="#cb22-39" tabindex="-1"></a><span class="fu">mean</span>(metrics_classic<span class="sc">$</span>tss)</span>
<span id="cb22-40"><a href="#cb22-40" tabindex="-1"></a><span class="co">#&gt; [1] 0.3773521</span></span></code></pre></div>
<p>The increase in mean AUC and TSS is even higher in 3-fold
cross-validation than on the fitted data. As we simulated the data with
a strong biotic signal, trophic SDM proves to be a better tool than
classic SDM.</p>
</div>
</div>
<div id="potential-niche" class="section level2">
<h2>Potential niche</h2>
<p>We also implemented a function to predict species potential niches,
defined as the probability of presence of species along the
environmental gradient when the biotic constrain is realised, i.e., when
all its prey are set to present (vice-versa, when modeling species
top-down, when the predator are absent). We here compute the probability
of presence of species at environmental conditions X_1= 0.5, X_2 = 0.5
when the preys are available.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>preds <span class="ot">=</span> <span class="fu">predictPotential</span>(m, <span class="at">Xnew =</span> <span class="fu">data.frame</span>(<span class="at">X_1 =</span> <span class="fl">0.5</span>, <span class="at">X_2 =</span> <span class="fl">0.5</span>))</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a><span class="co">#&gt; Error in predictPotential(m, Xnew = data.frame(X_1 = 0.5, X_2 = 0.5)): could not find function &quot;predictPotential&quot;</span></span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="co"># Take the posterior mean</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a><span class="fu">lapply</span>(preds,mean)</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a><span class="co">#&gt; Warning in mean.default(X[[i]], ...): l&#39;argomento non è numerico o logico: si restituisce NA</span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a><span class="co">#&gt; $predictions.prob</span></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a><span class="co">#&gt; [1] 0.9983807</span></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a><span class="co">#&gt; $predictions.bin</span></span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a><span class="co">#&gt; [1] NA</span></span></code></pre></div>
</div>
<div id="author" class="section level2">
<h2>Author</h2>
<p>This package is currently developed by Giovanni Poggiato from
Laboratoire d’Ecologie Alpine. It is supported by the ANR GAMBAS. The
framework implemented in this package is described in: “Integrating
trophic food webs in species distribution models improves ecological
niche estimation and prediction” Poggiato Giovanni, Jérémy Andréoletti,
Laura J. Pollock and Wilfried Thuiller. In preparation.</p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Grace, J. B., Johnson, D. J., Lefcheck, J. S., and Byrnes, J. E. K..
2018. Quantifying relative importance: computing standardized effects in
models with binary outcomes. Ecosphere 9(6):e02283.</p>
<p>Vehtari, A., Gelman, A., and Gabry, J. (2017). Practical Bayesian
model evaluation using leave-one-out cross-validation and WAIC.
Statistics and Computing. 27(5), 1413–1432.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
