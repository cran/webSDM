<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Subtle and obvious differences between SDM and trophic SDM</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Subtle and obvious differences between SDM
and trophic SDM</h1>



<div id="compare-trophic-and-classical-sdms-difference-and-equalities" class="section level2">
<h2>Compare trophic and classical SDMs: difference and equalities</h2>
<p>Here, we present the differences between a classic SDM and our
trophic SDM, starting from the simplest case when these two approaches
coincide to more realistic cases where they do not.</p>
<div id="the-simplest-case" class="section level3">
<h3>The simplest case</h3>
<p>Let’s consider a very simple case with one environmental covariate
<span class="math inline">\(x\)</span>, and two species <span class="math inline">\(y_A\)</span> and <span class="math inline">\(y_B\)</span>. We assume species <span class="math inline">\(y_A\)</span> to be basal and species <span class="math inline">\(y_B\)</span> to feed on <span class="math inline">\(y_A\)</span>. This leads to the following directed
acyclic graph that resumes the dependencies across variables, assuming
bottom-up control.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>G<span class="ot">=</span><span class="fu">graph_from_edgelist</span>(<span class="fu">as.matrix</span>(<span class="fu">data.frame</span>(<span class="at">from =</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>,<span class="st">&quot;x&quot;</span>,<span class="st">&quot;A&quot;</span>),</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>                                           <span class="at">to =</span>  <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;B&quot;</span>))))</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">plot</span>(G)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="plot of chunk igraph" />
<div class="figcaption">plot of chunk igraph</div>
</div>
<p>We now assume that data on species distributions are continuous
observable entities (e.g. basal area, biomass), that we can model with a
linear regression. We name <span class="math inline">\(y_{iA}\)</span>
and <span class="math inline">\(y_{iB}\)</span> the observations of
species <span class="math inline">\(y_A\)</span> and <span class="math inline">\(y_B\)</span> at site <span class="math inline">\(i\)</span>, respectively, and we assume that the
environment has a quadratic effect on both species. Therefore, using
classical SDMs, model equations are:<br />
<span class="math display">\[
\begin{aligned}
y_{iA} &amp;= \beta^{SDM}_{0A} + \beta^{SDM}_{1A} x_i +
\beta^{SDM}_{2A}x_i^2 + \epsilon_{iA}, \ \ \epsilon_{iA} \sim N(0,
\sigma_A^{SDM}) \\
y_{iB} &amp;= \beta^{SDM}_{0B} + \beta^{SDM}_{1B} x_i +
\beta^{SDM}_{2B}x_i^2 + \epsilon_{iB}, \ \ \epsilon_{iB} \sim N(0,
\sigma_B^{SDM})
\end{aligned}
\]</span></p>
<p>Instead, our trophic model includes a dependence of <span class="math inline">\(y_B\)</span> on its prey <span class="math inline">\(y_A\)</span>:<br />
<span class="math display">\[
\begin{aligned}
y_{iA} &amp;= \beta^{tSDM}_{0A} + \beta^{tSDM}_{1A} x_i +
\beta^{tSDM}_{2A}x_i^2 + \epsilon_{iA}, \ \ \epsilon_{iA} \sim N(0,
\sigma_A^{tSDM}) \\
y_{iB} &amp;= \beta^{tSDM}_{0B} + \beta^{tSDM}_{1B} x_i +
\beta^{tSDM}_{2B}x_i^2 + \alpha y_{iA} + \epsilon_{iB}, \ \
\epsilon_{iB} \sim N(0, \sigma_B^{tSDM})
\end{aligned}
\]</span></p>
<p>We hereafter focus on the expectation of the models (corresponding to
the predicted values), focusing in particular on species <span class="math inline">\(y_B\)</span> for which the two models are
different. For SDMs:<br />
<span class="math display">\[E[y_{iB} | \ x_i] = \beta^{SDM}_{0B} +
\beta^{SDM}_{1B} x_i + \beta^{SDM}_{2B}x_i^2 \]</span> For trophic SDM,
we need to condition on a value of <span class="math inline">\(y_{iA}\)</span>. We here choose to condition on
the expected value of <span class="math inline">\(y_{iA}\)</span>, which
corresponds to using predictions from <span class="math inline">\(y_A\)</span> to predict <span class="math inline">\(y_B\)</span>. In a linear model, with Gaussian
data and a linear interaction between prey and predator, we have that
<span class="math inline">\(E_A[E_B[y_B | \ y_A]] = E_B[y_B | \
E[y_A]]\)</span> (which is not necessarily true in other cases).<br />
We thus have:<br />
<span class="math display">\[E[y_{iB} | \ x_i, E[y_{iA}] ] =
\beta^{tSDM}_{0B} + \beta^{tSDM}_{1B} x_i + \beta^{tSDM}_{2B}x_i^2 +
\alpha E[y_{iA}] \]</span> We can rewrite the expected value of <span class="math inline">\(y_B\)</span> only as a function of the environment
<span class="math inline">\(x\)</span> only. <span class="math display">\[
\begin{aligned}
E[y_{iB} | \ x_i, E[y_{iA}] ] &amp;= \beta^{tSDM}_{0B} +
\beta^{tSDM}_{1B} x_i + \beta^{tSDM}_{2B}x_i^2 + \alpha
(\beta^{tSDM}_{0A} + \beta^{tSDM}_{1A} x_i + \beta^{tSDM}_{2A}x_i^2 ) \\
&amp; = \beta^{tSDM}_{0B} + \alpha \beta^{tSDM}_{0A} + (
\beta^{tSDM}_{1B} + \alpha \beta^{tSDM}_{1A}) x_i + (\beta^{tSDM}_{2B} +
\alpha \beta^{tSDM}_{2A}) x_i^2 \\
&amp;=  \beta^{SDM}_{0B} + \beta^{SDM}_{1B} x_i + \beta^{SDM}_{2B}x_i^2
\end{aligned}
\]</span></p>
<p>In this very simple case of a linear regression model with a linear
interactions between the predator and the preys, the estimation of the
regression coefficients is such that <span class="math display">\[\beta^{SDM}_{.B} = \beta^{tSDM}_{.B} + \alpha
\beta^{tSDM}_{.A} \]</span> As a consequence the models estimate the
same realised niche, and predictions from trophic and classical SDMs
coincide.<br />
However, our trophic model allows a separation of the direct effect of
the environment on <span class="math inline">\(y_B\)</span> (i.e., the
potential niche of <span class="math inline">\(y_B\)</span>) from its
indirect effect due to the effect of <span class="math inline">\(y_A\)</span> on <span class="math inline">\(y_B\)</span>. In other words, using the jargon of
structural equation models, <span class="math inline">\(\beta^{tSDM}_{1B}\)</span> and <span class="math inline">\(\beta^{tSDM}_{2B}\)</span> are the direct effects
of the environment on species <span class="math inline">\(y_B\)</span>
(i.e., its potential niche), the terms <span class="math inline">\(\alpha \beta^{tSDM}_{1A}\)</span> and <span class="math inline">\(\alpha \beta^{tSDM}_{2A}\)</span> are the indirect
effect of the environment on species <span class="math inline">\(y_B\)</span>. The sum of these two effects, <span class="math inline">\(\beta^{tSDM}_{1B} + \alpha
\beta^{tSDM}_{1A}\)</span> and <span class="math inline">\(\beta^{tSDM}_{2B} + \alpha
\beta^{tSDM}_{2A}\)</span> corresponds to the total effect of the
environment on <span class="math inline">\(y_B\)</span>, i.e., the
realised niche of <span class="math inline">\(y_B\)</span>. In this very
particular case, SDM can correctly estimate the total effect (the
realised niche), but cannot separate the direct and indirect effect of
the environment on <span class="math inline">\(y_B\)</span> and thus
they do not correctly estimate the potential niche.</p>
<div id="simulation" class="section level4">
<h4>Simulation</h4>
<p>We hereafter present a short example confirming the analytical
derivation of these results.</p>
<p>First, we simulate species distribution data accordingly to the
directed acyclic graph presented above. Therefore, the environment has a
quadratic effect on species <span class="math inline">\(y_A\)</span> and
species <span class="math inline">\(y_B\)</span>, with a linear effect
of <span class="math inline">\(y_A\)</span> on <span class="math inline">\(y_B\)</span>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1712</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co"># Create the environmental gradient</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="at">length.out=</span><span class="dv">100</span>)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co"># Simulate data for the basal species A </span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>A <span class="ot">=</span> <span class="dv">3</span><span class="sc">*</span>X <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>X<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co"># Simulate data for the predator species B</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>B <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>X <span class="sc">-</span><span class="dv">3</span><span class="sc">*</span>X<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>A  <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>oldpar <span class="ot">=</span> <span class="fu">par</span>()</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="fu">plot</span>(X,A, <span class="at">main =</span> <span class="st">&quot;Species A realised </span><span class="sc">\n</span><span class="st"> and potential niche&quot;</span>)</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="fu">plot</span>(X,B, <span class="at">main =</span> <span class="st">&quot;Species B realised niche&quot;</span>)</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="fu">plot</span>(X, <span class="dv">2</span><span class="sc">*</span>X <span class="sc">-</span><span class="dv">3</span><span class="sc">*</span>X<span class="sc">^</span><span class="dv">2</span>, <span class="at">main =</span> <span class="st">&quot;Species B potential niche&quot;</span>)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="plot of chunk simGauss" />
<div class="figcaption">plot of chunk simGauss</div>
</div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> oldpar<span class="sc">$</span>mfrow)</span></code></pre></div>
<p>We now run both a classic SDM and a trophic SDM</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># For species A, the two models coincide</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>m_A <span class="ot">=</span> <span class="fu">lm</span>(A <span class="sc">~</span> X <span class="sc">+</span> <span class="fu">I</span>(X<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co"># For species B, the two models are different:</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="do">## trophic model</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>m_trophic <span class="ot">=</span> <span class="fu">lm</span>(B <span class="sc">~</span> X <span class="sc">+</span> <span class="fu">I</span>(X<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> A)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="do">## classic SDM</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>m_SDM <span class="ot">=</span> <span class="fu">lm</span>(B <span class="sc">~</span> X <span class="sc">+</span> <span class="fu">I</span>(X<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<p>We can now test the relationships between the coefficients of SDM and
trophic SDM.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Show the equality of coefficients</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="fu">all.equal</span>(<span class="fu">coef</span>(m_SDM), <span class="fu">coef</span>(m_trophic)[<span class="sc">-</span><span class="dv">4</span>] <span class="sc">+</span> <span class="fu">coef</span>(m_trophic)[<span class="dv">4</span>]<span class="sc">*</span><span class="fu">coef</span>(m_A))</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="co"># Prediction coincide</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>pred_SDM <span class="ot">=</span> m_SDM<span class="sc">$</span>fitted.values</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>pred_trophic <span class="ot">=</span> <span class="fu">predict</span>(m_trophic,</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>                       <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">X =</span> X, <span class="at">A =</span> m_A<span class="sc">$</span>fitted.values))</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="fu">all.equal</span>(pred_SDM, pred_trophic)</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>The coefficient of classic SDM for species <span class="math inline">\(y_B\)</span> are equal to the environmental
coefficients of trophic SDM for species <span class="math inline">\(y_B\)</span> plus the indirect effect of the
environment on species <span class="math inline">\(y_B\)</span> (given
by the product of the biotic term and the environmental coefficients of
species <span class="math inline">\(y_A\)</span>). As a consequence, the
predictions of both models coincide when the predicted value of species
<span class="math inline">\(y_A\)</span> is used to predict <span class="math inline">\(y_B\)</span>. However, unlike the traditional SDM,
our trophic model allows to retrieve the correct potential niche of
species <span class="math inline">\(y_B\)</span></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Potential niche infered by SDM </span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">plot</span>(X, m_SDM<span class="sc">$</span>fitted.values, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">65</span>, <span class="dv">120</span>), <span class="at">ylab =</span> <span class="st">&quot;B&quot;</span>,</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Potential niche of yB&quot;</span>)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="fu">points</span>(X, <span class="fu">cbind</span>(<span class="dv">1</span>, X, X<span class="sc">^</span><span class="dv">2</span>) <span class="sc">%*%</span> <span class="fu">coef</span>(m_trophic)[<span class="sc">-</span><span class="dv">4</span>], <span class="at">col =</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="fu">points</span>(X,  <span class="dv">2</span><span class="sc">*</span>X <span class="sc">-</span><span class="dv">3</span><span class="sc">*</span>X<span class="sc">^</span><span class="dv">2</span>, <span class="at">col =</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="fu">legend</span>(<span class="sc">-</span><span class="fl">0.1</span>, <span class="dv">120</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;Potential niche inferred by SDM&quot;</span>,</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>                           <span class="st">&quot;Potential niche inferred by trophic SDM&quot;</span>,</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>                           <span class="st">&quot;True fundamenta niche&quot;</span>), <span class="at">pch =</span><span class="dv">1</span>,</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;black&quot;</span>,<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="at">cex =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfgAAAGwCAMAAABy/YdMAAABCFBMVEUAAAAAADoAAGYAAP8AOmYAOpAAZrY6AAA6ADo6AGY6OgA6OmY6OpA6Zjo6ZmY6ZpA6ZrY6kNtmAABmADpmAGZmOgBmOmZmZjpmZmZmZpBmkJBmkLZmkNtmtpBmtttmtv+QOgCQOjqQOmaQZjqQZmaQZpCQkGaQkJCQkLaQkNuQtmaQtpCQtraQttuQtv+Q27aQ29uQ2/+2ZgC2Zjq2Zma2ZpC2kDq2kGa2kJC2tma2tpC2ttu225C229u22/+2/7a2/9u2///bkDrbkGbbkJDbtmbbtpDbtrbb25Db27bb29vb2//b/7bb/9vb////AAD/tmb/tpD/25D/27b/29v//7b//9v///8lBGLCAAAACXBIWXMAAAsSAAALEgHS3X78AAASOElEQVR4nO2diXrbxhVGodgW28atIyVxbNm1FGttZLfWkkpNKseklCZ1Y4qhLc77v0lxsRErAcwCDOb+5wtMBoMZQDy4gzsDLp4ALPH6PgDQDxDPFIhnCsQzBeKZAvFMgXimQDxTIJ4pEM8UiGcKxDMF4pkC8UyBeKZAPFMgnikQzxSIZwrEMwXimQLxTIF4pkA8UyCeKQ6Iv9v0fNa2U6sWZ9tlW9Lqu83Pxsuay+eFFYudXGGO+chbO8kfhfdo2u7ge8MZ8RkLp16p+Pzqgvg0deJzjUVH4T0YiHknxPsv9uLU2xDi2o/CZ9PFji9gXSwu/P97ERj8buTdfxuuDmTPv/a8+yeJ+HiLcMVi16Pn/sp/f+3d9zeIGwpJ7YMkB+fHzNsI25qvOpWswinxp0HMrUfiw//bEMH/JqtJUBidD6ZL8eEWgfjwf+JHf2XSUEB6H0F0T/zIP107icSPEPGdkXT189Haaz/m/D6fumHfwVvxMTS5IX4mS7Q6lj0PToBEfLgFrZiPPnvrn0bbwcqZLzJpKKiW2Ue4Zp2ivuSCYzXOiPd77hmFZxiB/jLzIhOLnbWTsFtIxC/+s/cnLy0+2oJWzKLYTlYmDdHa7D7C7R78trmeXOPvo6vvisApUSne15sR/3Hz/o+/ZSI+2iIUvy4yK2vEi8na4Wgj6kn8bqI0rbQPl8SXdPVEUfzE+0L8PKoQT129+Ke3kaxMGiruI1rlrcWJ4qJiPGEfLomPE6/gSZzcPZimxYfJXRjDFeKXyV2q2nKcltpHpNiv4JfFXT2y+s5Yig+GWs9FEITr08XZKJhQWRqk1dTFL878zfzuulS88EspY1hWixvK7mMZ26d0HkTi7yO548NkKN17GohXpm6Kz04gXpVJ9jbBUIB4pkA8UyCeKRDPFIhnCsQzBeKZAvFMgXimQDxTIJ4pEM8UiGcKxDMF4pkC8UyBeKZAPFMgnikQzxQV8R6wGYPiFeoCnUSeM0Ig3n0C6fkYh3jHKYt2UbaiVbGxukATXmopFNTUU9kn6JnSbj4uqKmnsk/QJ1XdvKha2bjYWF2ggcpojwtr6qrsF/TFqmgXqwoaFRurCxSpTOrSG9TUV9k36ImV3Xy8QU19lX2LXmZuFQ7aDWq6eVFXqEe8QhNKO+ZLFO6128gXN6kL8Z1TG+715RA/OOrS+XgzpeImdSG+U2qzutR28sVN6kJ8dzSMdlG/jTbxwb+L9++bVl78WFXyy1XQzsJ/WvEV4GzF1w7ec9vKFzep64X/0MPN1X+fiU/iZuz/45u7Gf8y/SQu6ev8BT07fyeowH++ENdvgqciXONvQ4XEzZtfn1M7kw0x2dB/0IOmaTcfbytf3KRuKuJvrn59dnH1/eX4+upy9/X+5fj84Gr/cCrOXu/vHbw58lddXJHjb6iMtnmx+8Jfc/CP/WCbww9HQvz+9PXUP3POD7c+HPxN/0EPlxbdvKjfTu81/ubqf4sjcf303e7W/uPx+eH4/Lutx1u+6fH5N4/o4ezPW/tvxfkTvyzaxn/Yezj1z4bL6fXh8d+FeC8+PgvE/3D4CuKXtIn2eHv54iZ10+LHQly/2r84uX71dM8P95PzJ8eR+CcHr478h4NXT6eh+HG4DT1cHPsrz57tf3jp1/996+L59V+ePL/56fFPEB/RMtpF/bZWZfUfj1rtmA9tkrp0HfniJnUxnDNO224+riNf3KRu+HBL/2gZzpWQG+HxEi/RzYv67XWJvw3MaxnOjcN1C1pDtYojPFbiZaI9ridf3KRuKuJ1DOduxmcvDq6+333t/xfUmhZGeHzES0a7qK9j33Duxl/nt/Foev15WKs4wmMjXiapS9eVL25SV/Nw7vqE1u3vPjvaC2sVR3i8xEu+8WRIWX16OHe+4uc+eIhX6OZFfT2rxLfcsduoRHtcX764Sd3w4R798+n9+9QNtVYjNokdO4xitIv6uvVNz0fB+xtLfmkpLf5eYP7TxetIPI3C/BGbEMHg+3IajM8+iXiYFw7lsoO85jgvXiWpS7chX0w/rhX+xtKs+PvYxYj3MzNx9uJwehmM2m7Gl1Ma1fmjtYur/d1Xj394Hg/zrq/2C4M8bX/T0ImiXfHdxKri774aZx6LddNN+OLPfd0X39CoLRC/Nz57NL3819bjJ+/2PxzGw7yftx6P84O85rgt3iPp6n9kVxEfEoi//uvTCxq13dAzGtUdP907DsQfJcO841B8epDXHOfF1753umEz8sUi+dHUmmt8pzgsXkNWF7ekVNykLsTrQ8fFPdWUfHGTuhCvCX3RLuqb0TGc6x6ZF8J6dIzhcs3JFzdJ7oAeNHbzcXPyxaXDObcDrx/0dvOivilEvBVojva4Sfli0WA4BxTRH+2ivjmDs8GgGZqTunSz8sXG6oIEA9183Kx8sbG6IMRMNy/qm4T4XjEU7XHT8sVJbleW3UG8GuaiXdQ3W7/XxU7Fh5UhXg1DSV26efli4u7LE+m6oII42s1Ng+EabyOGoz3ehXyxsbrMMRzt8S7ki43VZY3RpC7ZiVKxsbqc0fTeqgZ7kS82VpctZsdw6R0pFRury5UOsrrUnuSLjdVlifkxXHpnSsXG6nKku2iP9yZfbKwuR7qL9nhv8sXG6rKjs6Qu2aFSsbG63Og22uM9yhcbq8uKzqNd1O8N4s3TbVKX3qt8sbG6bOh0CJfZsVKxsbpc6Cfa4z3LFxury4Leoj3YuVKxsboc6C/a473LFxury4H+oj3eu3yxsbrO08sQLnMASsXG6rpOv9EeH4F8sbG6btN3tIv6vUO8ATyh5XurlA9CodhYXXdZjuF6Pg6lYmN1naXfMVzuQOSLjdV1k15nbPLHolRsrK6TWBPtBMR3hE3RTkB8N1gV7QTEd4NV0U5AfAf0Pj9bAsSbx7poJyDeMDZGOwHxZrEuqYuBeIPYNoRLA/HmsDbaCYg3hM3RTkC8GayOdgLiTWB5tBMQbwAr3mlRA8TrxpZ3WtQA8Zqx/uIeAfE6sT2VTwHxGhlKtBMQr5GhRDsB8bqw9W5MBRCviSFFOwHxOhhYtBMQr4EhJXUxEK/KgIZwaSBekSFGOwHxKgw02gmIV2Co0U5AvCwDjnYC4iUZcrQTEC/DwKOdgHgJhh7tBMS3ZvjRTkB8W4bwvqoGQHwrBvK+qgYoi5+PKn5M2kXxLlzcI1TFL3a2g8fZg2nrugPDgVQ+har4u6/Gmcc2dYeFQ9FOIOIb4Va0E8rX+LtNBtd4x6KdQFZfi3vRThgQ78VIHZB1OBjthI7kjnr74iXeiVfKzWgnNIgPEvr5F+3r2o+j0U5oED9/OHVyOOdutBPK4jfX3rykiH/o2nDO4Wgn1JO7xY63LmaODefcjnYCw7kiy09HDPZPqAfiC8T3Xd2NdgLis4S6XbjhXgPEZ0j6eKejnYD4Je5ndCkgPoFBRpcC4kNYRTsB8QG8op2AeIbRTkA8w2gnuItnGe0Ec/E8o53gLJ5ttBNcxXss7sSsgKn41NSszYdpEJbiuUc7wVE8j/uuNbAT787nXdXgJh59fAQr8azHbznYiGc/fsvBRTzGbzlYiEe0F+EgHtFeQhPx85G3Piv9CLxK0x2BhK6cBuLpSy8mvvWSL71Qabob0MVX0EA8fR6SPhpX8rlIlaY7ANFejbPikdCtxlXxSOhqaCJ+M/pqk5bZXY8vOKK9FieHc7j9Vo974nH7rRFuiUdG1xinxCOja4474hHtrXBGPKK9HW6IxxRda4YvHl28FIMXjy5ejmGLR7RLM2jxiHZ5hiseCZ0SwxSPLl6ZQYpHF6/OAMUj2nUwMPGpbxxFtCsxLPGpPl5/47wYkHhkdDoZiPi0dIS7DoYhHtK1MwDx6OJNYLl4dPGmsFs8pBvDYvHo4k1iqXh08aaxUzykG8dG8ejiO8A28ZiM7wjLxGMyvitsEo80vkNsEY80vmMsEQ/pXWODeHTxPdC3+LT029tbES30AEzSqficWX/xUgupjpbbYFluXViAKp2JLzErKpeaYpwH6nQlPtB17969eEk9LVvip6LZeYGToDXK4uejqm/Eyoonl/5jsHgePY+eeslqX1u03KOFVuXPCVHfIeAEaISqePq+U6Lk+04zdcvM3uaWeDMSntl6udDZU9shZK4GoBxV8fG3Hqa+/dCLSW+XmA1DPIn48qW2OHselJwESaeAE6CcTiPex4uWSFnVEj+IZudF+iQQq9MAEKJ8jY++97LuGk9OJKbn8ueDqO8Q4s2RAqykq6zeyy2SNOoQ4hMg1QGUpgCs6Vy81sn4YmdQuBqUnwCZGSKWdCre6B2YmqsBlSwnkTIpAEv5nc3cdXbbbXmNr7z8ZyYRmV76+75JY4xVaQB1/SXyBafod1Z8TNUJsAx+nvKdFx+TlZ/J/crl93isXcBGPLGM/kzuF1/2c7mf2/JZiY8p7fnTXT+DCV+W4sWqS39l0u8WXMXHVMh3P+fjLp6oSPrdlg/xISXzfsWczyX5EJ8ll/SHp0L+HYMu5HsQXyTX8xfluzDag/hS8pf9rPzMaG+gQHwlK+SL4V/yIX4lFfIdyPcgvpaG8vs7QCkgvhFF+cHqtPyBRT3EN6ZkmE8MVD7Et6LBMH8g8iG+NRWXfDGsZA/iZSjL9wY2uQfxsqyWb/3kHsSrUHJfLz+51+fhrQLiVUnLL5ncszXqIV4HJfJtT/QhXhcDkw/xGimZ3LN2VhfidVL87J61UQ/xuklN7tk8sQfxJihP9K2SD/GGKMv1hEXXe4g3R8Xcjh0zuhBvkIq5HStmdCHeMDUTe70dF8R3QFF+/3kexHdD/nrfe5IP8R1RM6Pb+fFAfIdk5dOa/qIe4jsm+669/rp8iO+eVTO6nR0ExPfAikm9zqIe4vsh96at7rt8iO+NlfdxjO8d4vtj1X0c40EP8f1S3uV3MJUP8b3Tz1Q+xPdPL1P5EG8HuS7ffJ4H8dZQNZVvJuoh3h7yiZ7RLh/i7SKWb3xoD/HWkZvKNxT1EG8fK2Zz9e0E4m2kcjZXX9RDvJUU8zzd78iHeGtZ5nkmoh7ibcbgPRyIt5oV93AUW4Z42ymJeh037yDeekqiXqjnecri56Nmvx8PVMglehryPFXxi53t4HH2YNq6LmhD1TS+ZHOq4u++Gmce29QFrdAb9Yj4IbHim5XaonyNv9vENb47Kj6HIxH1yOqHRtXNu5bNQPzgqLh51zLqdSR31NsXL/EQb458nifaR70G8UFCP/9iWSemxWGAtqhGvQbx84dTDOe6RzHqlcVvrr15SRH/EMO5zlGJevXkbrHjrYsZhnN9oBD1yOoHjmzUQ/zQkYx6PeInG/J1gTIVUb+yDsS7QDHqa9+kA/GOUPZejVVRj2u8K2SjvvZSD/EOUfZB66qoh3iXaBH1EO8YTaMe4l0j+0HryqiHeAdp8iYdiHeRBpN5EO8mVZ+wT4B4R6mYwk+AeHcpmcxbAvEOk/+EfRqId5v892okQLzjVEU9xLtPadRDPANSn7BPgHgeQDxXcI0HARDPFIhnCsQzBeKZAvFMgXimQDxTTIoHNmNOvLmm9DZm7YH12RjEM20M4pk2BvFMG4N4po1BPNPGIJ5pY5iEYQrEMwXimQLxTIF4pkA8UyCeKRDPFIhnCsQzRZf4u82ynyuSZv7H4u8iSLY08rxtTW2JWenv70kT/5ijBiZey0PTJJ7+hMm6nrYEvcC6Xt+7L0/E/A8nehqj01HjX+nb0ib+tG1LmsTTTxXpi9LTtWNdbc3IU+tXZQX6/kox//xrXQe2+Lbtua1JPP1UEQWXLjS+vELrgWmM+MW3b7R19cHvwLZqTJN4+slhW8Uvdsq+bF+O+WhN2x852dB3jaerWbuodz/i7zb1eRcauw//JdOY3BGtrmhWXuP1ZvVaX1x9CcMkePO7zpOyD/HUnerMd7WJ1+pd9wVNX8TTkS1e9jCcs3YcH8aVrtfXb03fNV73OL7dkWHmjikQzxSIZwrEMwXimQLxTIF4pkA8UyCeKRDPFIhnCsQzBeKZAvFMgXimQDxTIJ4pEM8UiGcKxDMF4gMm9E7RU61vwLcciA853Q4+FMIHiA+ZP/zQ+nOHgwbiIyZPOHX0EJ+g/aNWlgPxIYtvj1ld4iE+YrbOK6mH+BDdn/a1H4gnwu9OmOj82KftQDxTIJ4pEM8UiGcKxDMF4pkC8UyBeKZAPFMgnikQzxSIZwrEMwXimQLxTIF4pkA8UyCeKf8H789EOyhangUAAAAASUVORK5CYII=" alt="plot of chunk potential" />
<div class="figcaption">plot of chunk potential</div>
</div>
</div>
</div>
</div>
<div id="does-this-always-hold" class="section level2">
<h2>Does this always hold?</h2>
<p>We showed that SDM and trophic SDM estimate the same realized niche,
and thus lead to the same predictions, when all the following conditions
hold:</p>
<ul>
<li>The relationship between predator and prey is linear<br />
</li>
<li>Species distribution are continuous abundances<br />
</li>
<li>The statistical model employed is a linear regression<br />
</li>
<li>The selected environmental variables are the same for prey and
predators</li>
</ul>
<p>However, as soon as at least one of these conditions does not hold,
the estimations of the realized niche (and so model prediction) differ.
We hereafter show that releasing just one of these constraints at a time
is enough to obtain predictions from trophic SDM that are different, and
better, than classical SDMs. Therefore, the example presented above is a
very particular case that is useful to understand model similarities,
but that rarely occurs in application.</p>
<div id="non-linear-relationship-between-prey-and-predator" class="section level3">
<h3>Non-linear relationship between prey and predator</h3>
<p>We hereafter release the conditions on the linearity of the
relationship between <span class="math inline">\(y_B\)</span> and <span class="math inline">\(y_A\)</span>. Indeed, we now consider that species
<span class="math inline">\(y_B\)</span> has a quadratic response to
<span class="math inline">\(y_A\)</span>. The classic SDM does not
change, as we model species as a function of the environment only.
Instead, the trophic model for species <span class="math inline">\(y_B\)</span> becomes:<br />
<span class="math display">\[y_{iB}= \beta^{tSDM}_{0B} +
\beta^{tSDM}_{1B} x_i + \beta^{tSDM}_{2B}x_i^2 + \alpha y_{iA}^2 +
\epsilon_{iB}, \ \ \epsilon_{iB} \sim N(0, \sigma_B^{tSDM})\]</span>
Predictions between trophic SDM and SDM are now different, since: <span class="math display">\[
\begin{aligned}
E[y_{iB} | \ x_i, E[y_{iA}] ] &amp;= \beta^{tSDM}_{0B} +
\beta^{tSDM}_{1B} x_i + \beta^{tSDM}_{2B}x_i^2 + \alpha
(\beta^{tSDM}_{0A} + \beta^{tSDM}_{1A} x_i + \beta^{tSDM}_{2A}x_i^2 )^2
\\
&amp; = \beta^{tSDM}_{0B} + \alpha(\beta^{tSDM}_{0A})^2+
(\beta^{tSDM}_{1B} + 2\alpha\beta^{tSDM}_{0A}\beta^{tSDM}_{1A}) x_i \\
&amp; \ \ \ \ + (\beta^{tSDM}_{2B} + \alpha
(2\beta^{tSDM}_{0A}\beta^{tSDM}_{2A} + (\beta^{tSDM}_{1A})^2))x_i^2 +
2\alpha\beta^{tSDM}_{1A}\beta^{tSDM}_{2A} x_i^3 +
\alpha(\beta^{tSDM}_{2A})^2x_i^4 \\
&amp;\neq \beta^{SDM}_{0B} + \beta^{SDM}_{1B} x_i +
\beta^{SDM}_{2B}x_i^2
\end{aligned}
\]</span></p>
<p>In order to correctly infer the realised niche, classic SDMs should
be specified with a polynomial of degree 4. As soon as we add multiple
environmental variables and link between species, classic SDM should be
specified with extremely complex formula, which is unfeasible for real
application.</p>
<div id="simulation-1" class="section level4">
<h4>Simulation</h4>
<p>We provide a simple example to demonstrate the analytical
computations with a simulation. We use the same example of above, but we
now simulate a quadratic relationship of <span class="math inline">\(y_B\)</span> with respect to <span class="math inline">\(y_A\)</span>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>B <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>X <span class="sc">-</span><span class="dv">3</span><span class="sc">*</span>X<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>A<span class="sc">^</span><span class="dv">2</span>  <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>oldpar <span class="ot">=</span> <span class="fu">par</span>()</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="fu">plot</span>(X,A, <span class="at">main =</span> <span class="st">&quot;Species A realised </span><span class="sc">\n</span><span class="st"> and potential niche&quot;</span>)</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="fu">plot</span>(X,B, <span class="at">main =</span> <span class="st">&quot;Species B realised niche&quot;</span>)</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="fu">plot</span>(X, <span class="dv">2</span><span class="sc">*</span>X <span class="sc">-</span><span class="dv">3</span><span class="sc">*</span>X<span class="sc">^</span><span class="dv">2</span>, <span class="at">main =</span> <span class="st">&quot;Species B potential niche&quot;</span>)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="plot of chunk simQuadr" />
<div class="figcaption">plot of chunk simQuadr</div>
</div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> oldpar<span class="sc">$</span>mfrow)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co"># Fit a trophic SDM</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>m_trophic <span class="ot">=</span> <span class="fu">lm</span>(B <span class="sc">~</span> X <span class="sc">+</span> <span class="fu">I</span>(X<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(A<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<p>We now compare the regression coefficients and predictions from the
two models</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Show the equality of coefficients</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">all.equal</span>(<span class="fu">coef</span>(m_SDM), <span class="fu">coef</span>(m_trophic)[<span class="sc">-</span><span class="dv">4</span>] <span class="sc">+</span> <span class="fu">coef</span>(m_trophic)[<span class="dv">4</span>]<span class="sc">*</span><span class="fu">coef</span>(m_A))</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Mean relative difference: 0.185587&quot;</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co"># Prediction are now different</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>pred_SDM <span class="ot">=</span> m_SDM<span class="sc">$</span>fitted.values</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>pred_trophic <span class="ot">=</span> <span class="fu">predict</span>(m_trophic,</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>                       <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">X =</span> X, <span class="at">A =</span> m_A<span class="sc">$</span>fitted.values))</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="fu">all.equal</span>(pred_SDM, pred_trophic)</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Mean relative difference: 53.61947&quot;</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">#Compare R2</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="fu">cor</span>(B, pred_SDM)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co">#&gt; [1] 0.8339402</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="fu">cor</span>(B, pred_trophic)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="co">#&gt; [1] 0.9605349</span></span></code></pre></div>
<p>The relationship between the coefficients of the two models does not
hold anymore more, and predictions are now different, with trophic SDM
reaching a far better predictive accuracy than classic SDM for species
<span class="math inline">\(y_B\)</span> (R2 of 0.83 and 0.96
respectively).</p>
</div>
</div>
<div id="non-continuous-observable-entities-presence-absence-counts" class="section level3">
<h3>Non-continuous observable entities (presence-absence, counts)</h3>
<p>Let’s now consider here the case of presence-absences (i.e., binary
data), without modifying the other two conditions. Therefore, we use a
(generalized) linear model like logistic regression, and we model a
linear relationship (at the link level) between predator and prey. Thus,
for SDM we have:<br />
<span class="math display">\[
\begin{aligned}
p(y_{iA}= 1) &amp;= \text{logit}^{-1}(\beta^{SDM}_{0A} +
\beta^{SDM}_{1A} x_i + \beta^{SDM}_{2A}x_i^2) \\
p(y_{iB} = 1) &amp;= \text{logit}^{-1}(\beta^{SDM}_{0B} +
\beta^{SDM}_{1B} x_i + \beta^{SDM}_{2B}x_i^2)
\end{aligned}
\]</span><br />
Instead, our trophic model includes a dependence of <span class="math inline">\(y_B\)</span> on its prey <span class="math inline">\(y_A\)</span>:<br />
<span class="math display">\[p(y_{iB} = 1) = \text{logit}^{-1}
(\beta^{tSDM}_{0B} + \beta^{tSDM}_{1B} x_i + \beta^{tSDM}_{2B}x_i^2 +
\alpha y_A)\]</span> The equality between the models does not hold
anymore due to the non linearity of the logit function. Indeed: <span class="math display">\[
\begin{aligned}
E[y_{iB} | \  x_i, E[y_{iA}] ] &amp;= p(y_{iB} = 1 | \ x_i, p(y_{iA} =
1)) \\
&amp;= \text{logit}^{-1}(\beta^{tSDM}_{0B} + \beta^{tSDM}_{1B} x_i +
\beta^{tSDM}_{2B}x_i^2 + \alpha \text{logit}^{-1}(\beta^{tSDM}_{0A} +
\beta^{tSDM}_{1A} x_i + \beta^{tSDM}_{2A}x_i^2))\\
&amp;\neq \text{logit}^{-1}(\beta^{SDM}_{0B} + \beta^{SDM}_{1B} x_i +
\beta^{SDM}_{2B}x_i^2)
\end{aligned}
\]</span></p>
<div id="simulations" class="section level4">
<h4>Simulations</h4>
<p>We now confirm this analytical derivation with a simple example. The
code is very similar to the previous one, but we now generate binary
data from a logistic model.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># Generate the link layer basal species</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>V_A<span class="ot">=</span> <span class="dv">3</span><span class="sc">*</span>X <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>X<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="co"># Transform to probability</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>prob_A <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>V_A))</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co"># Sample the binary data</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>A <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> prob_A)</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co"># Same for species B</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>V_B <span class="ot">=</span> <span class="sc">-</span><span class="dv">3</span><span class="sc">*</span>X <span class="sc">+</span><span class="dv">1</span><span class="sc">*</span>X<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>A</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>prob_B <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>V_B))</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>B <span class="ot">=</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="dv">100</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> prob_B)</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>oldpar <span class="ot">=</span> <span class="fu">par</span>()</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="fu">plot</span>(X,prob_A, <span class="at">main =</span> <span class="st">&quot;Species A realised </span><span class="sc">\n</span><span class="st"> and potential niche&quot;</span>)</span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a><span class="fu">plot</span>(X,prob_B, <span class="at">main =</span> <span class="st">&quot;Species B realised niche&quot;</span>)</span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a><span class="fu">plot</span>(X, <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span>(<span class="sc">-</span><span class="dv">3</span><span class="sc">*</span>X <span class="sc">+</span><span class="dv">1</span><span class="sc">*</span>X<span class="sc">^</span><span class="dv">2</span>))), <span class="at">main =</span> <span class="st">&quot;Species B potential niche&quot;</span>)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="plot of chunk simlogi" />
<div class="figcaption">plot of chunk simlogi</div>
</div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> oldpar<span class="sc">$</span>mfrow)</span></code></pre></div>
<p>We then fit a classic SDM and a trophic SDM</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># For species A, the two models coincide</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>m_A <span class="ot">=</span> <span class="fu">glm</span>(A <span class="sc">~</span> X <span class="sc">+</span> <span class="fu">I</span>(X<span class="sc">^</span><span class="dv">2</span>), <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co"># For species B, the two models are different:</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>m_SDM <span class="ot">=</span> <span class="fu">glm</span>(B <span class="sc">~</span> X <span class="sc">+</span> <span class="fu">I</span>(X<span class="sc">^</span><span class="dv">2</span>), <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>m_trophic <span class="ot">=</span> <span class="fu">glm</span>(B <span class="sc">~</span> X <span class="sc">+</span> <span class="fu">I</span>(X<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> A, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">&quot;logit&quot;</span>))</span></code></pre></div>
<p>We now test the relationships between model coefficients and whether
the equality of model predictions still holds</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># Equality of the coefficient does not hold anymore</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">all.equal</span>(<span class="fu">coef</span>(m_SDM), <span class="fu">coef</span>(m_trophic)[<span class="sc">-</span><span class="dv">4</span>] <span class="sc">+</span> <span class="fu">coef</span>(m_trophic)[<span class="dv">4</span>]<span class="sc">*</span><span class="fu">coef</span>(m_A))</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Mean relative difference: 2.305022&quot;</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co"># Predictions do not coincide anymore</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>pred_SDM <span class="ot">=</span> m_SDM<span class="sc">$</span>fitted.values</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>pred_trophic <span class="ot">=</span> <span class="fu">predict</span>(m_trophic,</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>                       <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">X =</span> X, <span class="at">A =</span> m_A<span class="sc">$</span>fitted.values))</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="fu">all.equal</span>(pred_SDM, pred_trophic)</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Mean relative difference: 2.915665&quot;</span></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a><span class="co"># Predictions are improved by trophic SDM</span></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a><span class="do">## AUC of species B for SDM</span></span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a>dismo<span class="sc">::</span><span class="fu">evaluate</span>(<span class="at">p =</span> pred_SDM[<span class="fu">which</span>(B<span class="sc">==</span><span class="dv">1</span>)],</span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a>                <span class="at">a =</span> pred_SDM[<span class="fu">which</span>(B<span class="sc">==</span><span class="dv">0</span>)] )<span class="sc">@</span>auc</span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a><span class="co">#&gt; [1] 0.8408333</span></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a></span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a><span class="do">## AUC of species B for trophic SDM</span></span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a>dismo<span class="sc">::</span><span class="fu">evaluate</span>(<span class="at">p =</span> pred_trophic[<span class="fu">which</span>(B<span class="sc">==</span><span class="dv">1</span>)],</span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a>                <span class="at">a =</span> pred_trophic[<span class="fu">which</span>(B<span class="sc">==</span><span class="dv">0</span>)] )<span class="sc">@</span>auc</span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a><span class="co">#&gt; [1] 0.8529167</span></span></code></pre></div>
<p>The relationship between the coefficients of the two models does not
hold anymore more, and predictions are now different, with trophic SDM
that slightly improve classic SDM (AUC of species <span class="math inline">\(y_B\)</span> goes from 0.84 to 0.85).</p>
</div>
</div>
<div id="non-linear-statistical-model" class="section level3">
<h3>Non-linear statistical model</h3>
<p>We finally show how using a non-linear statistical model leads to
different predictions between classical SDMs and a trophic SDM with the
example of a random forest. Since we cannot provide any analytical
derivation for random forest, we simply provide an example. Data are
simulated exactly as in the very first examples (continuous observable
entities).</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># Simulate data for the basal species A </span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>A <span class="ot">=</span> <span class="dv">3</span><span class="sc">*</span>X <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>X<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co"># Simulate data for the predator species B</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>B <span class="ot">=</span> <span class="dv">2</span><span class="sc">*</span>X <span class="sc">-</span><span class="dv">3</span><span class="sc">*</span>X<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span>A  <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">5</span>)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>oldpar <span class="ot">=</span> <span class="fu">par</span>()</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="fu">plot</span>(X,A, <span class="at">main =</span> <span class="st">&quot;Species A realised </span><span class="sc">\n</span><span class="st"> and potential niche&quot;</span>)</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="fu">plot</span>(X,B, <span class="at">main =</span> <span class="st">&quot;Species B realised niche&quot;</span>)</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="fu">plot</span>(X, <span class="dv">2</span><span class="sc">*</span>X <span class="sc">-</span><span class="dv">3</span><span class="sc">*</span>X<span class="sc">^</span><span class="dv">2</span>, <span class="at">main =</span> <span class="st">&quot;Species B potential niche&quot;</span>)</span></code></pre></div>
<div class="float">
<img src="data:image/png;base64,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" alt="plot of chunk simRF" />
<div class="figcaption">plot of chunk simRF</div>
</div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> oldpar<span class="sc">$</span>mfrow)</span></code></pre></div>
<p>We infer statistical models with random forest</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="co">#&gt; randomForest 4.7-1.1</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="co">#&gt; Type rfNews() to see new features/changes/bug fixes.</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="co"># Species A</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>m_A  <span class="ot">=</span> <span class="fu">randomForest</span>(A <span class="sc">~</span> X <span class="sc">+</span> <span class="fu">I</span>(X<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="co"># Species B trophic SDM</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>m_trophic <span class="ot">=</span> <span class="fu">randomForest</span>(B <span class="sc">~</span> X <span class="sc">+</span> <span class="fu">I</span>(X<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> A)</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="co"># Species B classic SDM</span></span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>m_SDM <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(B <span class="sc">~</span> X <span class="sc">+</span> <span class="fu">I</span>(X<span class="sc">^</span><span class="dv">2</span>))</span></code></pre></div>
<p>We now compare the predictions from the two models.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># Prediction are now different</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>pred_SDM <span class="ot">=</span> m_SDM<span class="sc">$</span>predicted</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>pred_trophic <span class="ot">=</span> <span class="fu">predict</span>(m_trophic,</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>                       <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">X =</span> X, <span class="at">A =</span> m_A<span class="sc">$</span>predicted))</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="fu">all.equal</span>(pred_SDM, pred_trophic)</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Mean relative difference: 0.08021014&quot;</span></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a><span class="co">#Compare R2</span></span>
<span id="cb17-10"><a href="#cb17-10" tabindex="-1"></a><span class="fu">cor</span>(B, pred_SDM)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb17-11"><a href="#cb17-11" tabindex="-1"></a><span class="co">#&gt; [1] 0.8075415</span></span>
<span id="cb17-12"><a href="#cb17-12" tabindex="-1"></a><span class="fu">cor</span>(B, pred_trophic)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb17-13"><a href="#cb17-13" tabindex="-1"></a><span class="co">#&gt; [1] 0.8670482</span></span></code></pre></div>
<p>Predictions from the model are different, and trophic SDM has a
larger R2 than classical SDMs (0.86 versus 0.80).</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
